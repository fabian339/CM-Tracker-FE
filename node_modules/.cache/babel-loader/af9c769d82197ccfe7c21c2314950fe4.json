{"ast":null,"code":"import { SET_ADMIN, SET_ERRORS, CLEAR_ERRORS, LOADING_UI, SET_AUTHENTICATED_ADMIN, SET_UNAUTHENTICATED_ADMIN, SET_AUTHENTICATED_USER, LOADING_ADMIN, STOP_LOADING_UI, SET_ORGANIZATION, MARCK_NOTIFICATIONS_READ, ADD_ORGANIZATION, SET_ORGANIZATIONS, LOADING_DATA, SET_AUTHENTICATED_PATHNAMES } from '../types';\nimport { getUserData, logoutUser } from './userActions';\nimport axios from 'axios';\nexport const loginFunc = (data, history) => dispatch => {\n  dispatch({\n    type: LOADING_UI\n  });\n  axios.post('/login', data).then(res => {\n    // console.log(res.data)\n    setAuthorizationHeader(res.data.token, res.data.accountType, res.data.fullname);\n\n    if (res.data.accountType === \"admin\") {\n      console.log(\"Data Back\", res.data.fullname, \"History\", history);\n      dispatch(getAdminData(res.data.fullname));\n      let pathName = `/admin/${res.data.fullname}/modules`;\n      dispatch({\n        type: SET_AUTHENTICATED_ADMIN\n      }); // dispatch({\n      //     type: SET_AUTHENTICATED_PATHNAMES,\n      //     payload: pathName\n      // })\n\n      dispatch({\n        type: CLEAR_ERRORS\n      });\n      history.push(pathName);\n    } else {\n      dispatch(getUserData());\n      dispatch({\n        type: SET_AUTHENTICATED_ADMIN,\n        payload: res.data.fullame\n      });\n      dispatch({\n        type: CLEAR_ERRORS\n      });\n      history.push(`/user/${res.data.fullname}/page`);\n    }\n  }).catch(err => {\n    dispatch({\n      type: SET_ERRORS,\n      payload: err.response.data\n    });\n  });\n};\nexport const adminRegistration = (newAdminData, history, newPath) => dispatch => {\n  dispatch({\n    type: LOADING_UI\n  });\n  axios.post('/registerAdmin', newAdminData).then(res => {\n    setAuthorizationHeader(res.data.token, 'admin');\n    dispatch(getAdminData());\n    dispatch({\n      type: SET_AUTHENTICATED_ADMIN\n    });\n    dispatch({\n      type: CLEAR_ERRORS\n    }); // dispatch({\n    //     type: SET_AUTHENTICATED_PATHNAMES,\n    //     payload: newPath\n    // })\n\n    history.push(newPath);\n  }).catch(err => {\n    console.log(err);\n    dispatch({\n      type: SET_ERRORS,\n      payload: err.response.data\n    });\n  });\n};\nexport const registerOrg = (newOrgData, history, fullname) => dispatch => {\n  dispatch({\n    type: LOADING_UI\n  });\n  axios.post('/orgRegister', newOrgData).then(res => {\n    console.log(\"CALLED\");\n    dispatch({\n      type: ADD_ORGANIZATION,\n      payload: res.data\n    });\n    dispatch({\n      type: CLEAR_ERRORS\n    });\n    dispatch(mergeAdminWithOrg(fullname, res.data.orgId));\n    let pathName = `/merge/admin/${fullname}/organization/${res.data.orgId}`; // dispatch({\n    //     type: SET_AUTHENTICATED_PATHNAMES,\n    //     payload: pathName\n    // })\n\n    history.push(pathName);\n  }).catch(err => {\n    console.log(err);\n    dispatch({\n      type: SET_ERRORS,\n      payload: err.response.data\n    }); //   console.log(err.response)\n  });\n}; //get organization with name\n\nexport const getOrgWithName = (orgName, history, fullname) => dispatch => {\n  dispatch({\n    type: LOADING_UI\n  });\n  axios.get(`/organization/${orgName}`).then(res => {\n    console.log(\"CALLED\");\n    dispatch({\n      type: SET_ORGANIZATION,\n      payload: res.data\n    });\n    dispatch(mergeAdminWithOrg(fullname, res.data.orgId));\n    let pathName = `/merge/admin/${fullname}/organization/${res.data.orgId}`; // dispatch({\n    //     type: SET_AUTHENTICATED_PATHNAMES,\n    //     payload: pathName\n    // })\n\n    history.push(`/merge/admin/${fullname}/organization/${res.data.orgId}`);\n  }).catch(err => {\n    console.log(err);\n    dispatch({\n      type: SET_ERRORS,\n      payload: err.response.data\n    }); //   console.log(err.response)\n  });\n}; //get all organizations\n\nexport const getOrganizations = () => dispatch => {\n  // console.log(\"BEIN CALLED\");\n  dispatch({\n    type: LOADING_DATA\n  });\n  axios.get('/organizations').then(res => {\n    dispatch({\n      type: SET_ORGANIZATIONS,\n      payload: res.data\n    });\n  }).catch(err => {\n    dispatch({\n      type: SET_ORGANIZATIONS,\n      payload: []\n    });\n  });\n};\nexport const mergeAdminWithOrg = (fullname, orgId) => dispatch => {\n  dispatch({\n    type: LOADING_UI\n  });\n  axios.put(`/merge/admin/${fullname}/organization/${orgId}`).then(res => {\n    console.log(res);\n    dispatch(getAdminData(fullname)); // dispatch({ type: CLEAR_ERRORS});\n  }).catch(err => {\n    console.log(err);\n    dispatch({\n      type: SET_ERRORS,\n      payload: err.response.data\n    });\n  });\n}; // export const getOrgData = (orgId) => (dispatch) => {\n//     dispatch({ type: LOADING_UI });\n//     axios.get(`/organization/${orgId}`)\n//     .then((res) => {\n//         dispatch({\n//             type: SET_ORGANIZATION,\n//             payload: res.data\n//         });\n//         dispatch({ type: STOP_LOADING_UI })\n//     })\n//     .catch(err =>  console.log(err) );\n// }\n\nexport const logoutAdmin = () => dispatch => {\n  if (localStorage.accType === \"admin\") {\n    localStorage.removeItem('FBIdToken');\n    delete axios.defaults.headers.common['Authorization'];\n    dispatch({\n      type: SET_UNAUTHENTICATED_ADMIN\n    });\n  } else {\n    dispatch(logoutUser());\n  }\n\n  localStorage.removeItem('accType');\n  localStorage.removeItem('fullname');\n};\nexport const getAdminData = fullname => dispatch => {\n  dispatch({\n    type: LOADING_ADMIN\n  });\n  console.log(\"Calledd\", fullname);\n  axios.get(`/admin/${fullname}`).then(res => {\n    dispatch({\n      type: SET_ADMIN,\n      payload: res.data\n    }); // console.log(\"PayloadData-->\", res.data)\n  }).catch(err => {\n    console.log(err.response.data);\n    dispatch({\n      type: SET_ERRORS,\n      payload: err.response.data\n    });\n  });\n}; // export const uploadImage = (formData) => (dispatch) => {\n//     // dispatch( { type: ON_IMAGE_CHANGE });\n//     dispatch({ type: LOADING_USER });\n//     axios.post('/user/image', formData)\n//     .then(() => {\n//         dispatch(getUserData());\n//         //refetch secrets from serve after 2 seconds to avoid incorrect data\n//         setTimeout(() => {dispatch(getSecrets(true))}, 2500);\n//     })\n//     .catch(err => console.log(err));\n// }\n// export const editUserDetails = (userDetails) => (dispatch) => {\n//     dispatch({ type: LOADING_USER});\n//     axios.post('/user', userDetails)\n//     .then(() => {\n//         dispatch(getUserData());\n//     })\n//     .catch(err => console.log(err));\n// }\n// export const markNotificationsRead = (notificationIds) => (dispatch) => {\n//     axios.post('/notifications', notificationIds)\n//     .then(res => {\n//         dispatch({ type: MARCK_NOTIFICATIONS_READ })\n//     })\n//     .catch(err => console.log(err));\n// }\n\nconst setAuthorizationHeader = (token, accType, fullname) => {\n  const FBIdToken = `Bearer ${token}`;\n  localStorage.setItem('FBIdToken', FBIdToken);\n  localStorage.setItem('accType', accType);\n  localStorage.setItem('fullname', fullname);\n  axios.defaults.headers.common['Authorization'] = FBIdToken;\n};","map":{"version":3,"sources":["/Users/mrfabian/Documents/cm-tracker-project/CM-Tracker-FE/src/redux/actions/adminActions.js"],"names":["SET_ADMIN","SET_ERRORS","CLEAR_ERRORS","LOADING_UI","SET_AUTHENTICATED_ADMIN","SET_UNAUTHENTICATED_ADMIN","SET_AUTHENTICATED_USER","LOADING_ADMIN","STOP_LOADING_UI","SET_ORGANIZATION","MARCK_NOTIFICATIONS_READ","ADD_ORGANIZATION","SET_ORGANIZATIONS","LOADING_DATA","SET_AUTHENTICATED_PATHNAMES","getUserData","logoutUser","axios","loginFunc","data","history","dispatch","type","post","then","res","setAuthorizationHeader","token","accountType","fullname","console","log","getAdminData","pathName","push","payload","fullame","catch","err","response","adminRegistration","newAdminData","newPath","registerOrg","newOrgData","mergeAdminWithOrg","orgId","getOrgWithName","orgName","get","getOrganizations","put","logoutAdmin","localStorage","accType","removeItem","defaults","headers","common","FBIdToken","setItem"],"mappings":"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","sourcesContent":["import { \n    SET_ADMIN, \n    SET_ERRORS, \n    CLEAR_ERRORS, \n    LOADING_UI, \n    SET_AUTHENTICATED_ADMIN,\n    SET_UNAUTHENTICATED_ADMIN, \n    SET_AUTHENTICATED_USER,\n    LOADING_ADMIN,\n    STOP_LOADING_UI,\n    SET_ORGANIZATION, \n    MARCK_NOTIFICATIONS_READ,\n    ADD_ORGANIZATION,\n    SET_ORGANIZATIONS,\n    LOADING_DATA,\n    SET_AUTHENTICATED_PATHNAMES\n    \n    } from '../types';\n\n    import {getUserData, logoutUser} from './userActions'\n\nimport axios from 'axios';\n\nexport const loginFunc = (data, history) => (dispatch) => {\n    dispatch({ type: LOADING_UI });\n    axios.post('/login', data)\n    .then((res) => {\n        // console.log(res.data)\n        setAuthorizationHeader(res.data.token, res.data.accountType, res.data.fullname);\n        if(res.data.accountType === \"admin\"){\n            console.log(\"Data Back\", res.data.fullname, \"History\", history);\n            dispatch(getAdminData(res.data.fullname));\n            let pathName = `/admin/${res.data.fullname}/modules`\n            dispatch({type: SET_AUTHENTICATED_ADMIN});\n            // dispatch({\n            //     type: SET_AUTHENTICATED_PATHNAMES,\n            //     payload: pathName\n            // })\n            dispatch({ type: CLEAR_ERRORS});\n            history.push(pathName);\n        } else {\n            dispatch(getUserData());\n            dispatch({\n                type: SET_AUTHENTICATED_ADMIN,\n                payload: res.data.fullame\n            });\n            dispatch({ type: CLEAR_ERRORS});\n            history.push(`/user/${res.data.fullname}/page`);\n        }\n    })\n    .catch(err => {\n      dispatch({\n          type: SET_ERRORS,\n          payload: err.response.data\n      })\n\n    });\n}\n\n\nexport const adminRegistration = (newAdminData, history, newPath) => (dispatch) => {\n\n    dispatch({ type: LOADING_UI });\n    axios.post('/registerAdmin', newAdminData)\n    .then((res) => {\n        setAuthorizationHeader(res.data.token, 'admin');\n        dispatch(getAdminData());\n        dispatch({type: SET_AUTHENTICATED_ADMIN});\n        dispatch({ type: CLEAR_ERRORS});\n        // dispatch({\n        //     type: SET_AUTHENTICATED_PATHNAMES,\n        //     payload: newPath\n        // })\n        history.push(newPath);\n    })\n    .catch(err => {\n        console.log(err)\n      dispatch({\n          type: SET_ERRORS,\n          payload: err.response.data\n      })\n\n    });\n}\n\nexport const registerOrg = (newOrgData, history, fullname) => (dispatch) => {\n    dispatch({ type: LOADING_UI });\n    axios.post('/orgRegister', newOrgData)\n    .then((res) => {\n        console.log(\"CALLED\")\n        dispatch({\n            type: ADD_ORGANIZATION,\n            payload: res.data\n        });\n        dispatch({ type: CLEAR_ERRORS});\n        dispatch(mergeAdminWithOrg(fullname, res.data.orgId));\n        let pathName = `/merge/admin/${fullname}/organization/${res.data.orgId}`;\n        // dispatch({\n        //     type: SET_AUTHENTICATED_PATHNAMES,\n        //     payload: pathName\n        // })\n        history.push(pathName);\n    })\n    .catch(err => {\n        console.log(err)\n      dispatch({\n          type: SET_ERRORS,\n          payload: err.response.data\n      })\n    //   console.log(err.response)\n    });\n}\n\n//get organization with name\nexport const getOrgWithName = (orgName, history, fullname) => (dispatch) => {\n    dispatch({ type: LOADING_UI });\n    axios.get(`/organization/${orgName}`)\n    .then((res) => {\n        console.log(\"CALLED\")\n        dispatch({\n            type: SET_ORGANIZATION,\n            payload: res.data\n        });\n        dispatch(mergeAdminWithOrg(fullname, res.data.orgId));\n        let pathName = `/merge/admin/${fullname}/organization/${res.data.orgId}`;\n        // dispatch({\n        //     type: SET_AUTHENTICATED_PATHNAMES,\n        //     payload: pathName\n        // })\n        history.push(`/merge/admin/${fullname}/organization/${res.data.orgId}`);\n    })\n    .catch(err => {\n        console.log(err)\n      dispatch({\n          type: SET_ERRORS,\n          payload: err.response.data\n      })\n    //   console.log(err.response)\n    });\n}\n\n\n//get all organizations\nexport const getOrganizations = () => (dispatch) => {\n        // console.log(\"BEIN CALLED\");\n        dispatch( { type: LOADING_DATA });\n        axios.get('/organizations')\n        .then((res) => {\n            dispatch({\n                type: SET_ORGANIZATIONS,\n                payload: res.data\n            });\n        })\n        .catch(err => {\n            dispatch({\n                type: SET_ORGANIZATIONS,\n                payload: []\n            });\n        });\n    }\n\n\nexport const mergeAdminWithOrg = (fullname, orgId) => dispatch => {\n    dispatch({ type: LOADING_UI });\n    axios.put(`/merge/admin/${fullname}/organization/${orgId}`)\n    .then(res => {\n        console.log(res)\n        dispatch(getAdminData(fullname));\n        // dispatch({ type: CLEAR_ERRORS});\n    })\n    .catch(err => {\n        console.log(err)\n      dispatch({\n          type: SET_ERRORS,\n          payload: err.response.data\n      })\n    })\n}\n// export const getOrgData = (orgId) => (dispatch) => {\n//     dispatch({ type: LOADING_UI });\n//     axios.get(`/organization/${orgId}`)\n//     .then((res) => {\n//         dispatch({\n//             type: SET_ORGANIZATION,\n//             payload: res.data\n//         });\n//         dispatch({ type: STOP_LOADING_UI })\n//     })\n//     .catch(err =>  console.log(err) );\n// }\n\n\n\nexport const logoutAdmin = () => (dispatch) => {\n    if (localStorage.accType === \"admin\"){\n        localStorage.removeItem('FBIdToken');\n        delete axios.defaults.headers.common['Authorization'];\n        dispatch({ type: SET_UNAUTHENTICATED_ADMIN });\n    } else {\n        dispatch(logoutUser());\n    }\n    localStorage.removeItem('accType');\n    localStorage.removeItem('fullname');\n}\n\n\n\nexport const getAdminData = (fullname) => (dispatch) => {\n    dispatch({ type: LOADING_ADMIN });\n            console.log(\"Calledd\", fullname)\n\n    axios.get(`/admin/${fullname}`)\n    .then((res) => {\n        dispatch({\n            type: SET_ADMIN,\n            payload: res.data\n        })\n        // console.log(\"PayloadData-->\", res.data)\n    })\n    .catch(err => {\n        console.log(err.response.data)\n      dispatch({\n          type: SET_ERRORS,\n          payload: err.response.data\n      })\n    })\n}\n\n\n// export const uploadImage = (formData) => (dispatch) => {\n//     // dispatch( { type: ON_IMAGE_CHANGE });\n//     dispatch({ type: LOADING_USER });\n//     axios.post('/user/image', formData)\n//     .then(() => {\n//         dispatch(getUserData());\n//         //refetch secrets from serve after 2 seconds to avoid incorrect data\n//         setTimeout(() => {dispatch(getSecrets(true))}, 2500);\n//     })\n//     .catch(err => console.log(err));\n// }\n\n\n// export const editUserDetails = (userDetails) => (dispatch) => {\n//     dispatch({ type: LOADING_USER});\n\n//     axios.post('/user', userDetails)\n//     .then(() => {\n//         dispatch(getUserData());\n//     })\n//     .catch(err => console.log(err));\n// }\n\n\n// export const markNotificationsRead = (notificationIds) => (dispatch) => {\n//     axios.post('/notifications', notificationIds)\n//     .then(res => {\n//         dispatch({ type: MARCK_NOTIFICATIONS_READ })\n//     })\n//     .catch(err => console.log(err));\n// }\n\n\nconst setAuthorizationHeader = (token, accType, fullname) => {\n    const FBIdToken = `Bearer ${token}`;\n    localStorage.setItem('FBIdToken', FBIdToken);\n    localStorage.setItem('accType', accType);\n    localStorage.setItem('fullname', fullname);\n    axios.defaults.headers.common['Authorization'] = FBIdToken;\n}"]},"metadata":{},"sourceType":"module"}